---
title: 当心你的加密文件
date: 2007-04-27 15:06:15
img: '/medias/7.jpg'
categories:
- 系统知识
---

## 当心你的加密文件
　　从Windows 2000开始，在NTFS文件系统的分区中Windows可以帮助你加密文件。方法是，在想加密的文件或文件夹上点右键，选择“属性”，在属性的“常规”选项卡上点击“高级”按钮，会弹出一个窗口，选中窗口中的“加密内容以便保护数据”即可实现在NTFS卷上对文件的加密。

　　**小提示**

　　这被称作为EFS(Encrypting File System，加密文件系统)。这种加密的好处是，加密的过程是完全透明的，也就是说，如果你加密了这些文件，你对这些文件的访问将完全允许(并不需要你输入密码，因为验证过程在你登录Windows的时候就进行了)，而其它人则不能访问或移动这些数据。

　　不过如果你的Windows突然崩溃，在无计可施的情况下只能重装系统，但原来被加密过的数据会出现无法打开的问题。这时只有在域环境下，才可以得到域管理员的帮助，解密这些文件。这是因为当你使用EFS加密后，系统会根据你的SID(Security Identifier，安全标示符)自动生成一个密钥，要解密这些文件就要使用这个密钥。对于系统而言，并不是根据用户名来区别不同的用户，而是根据SID，这个SID是唯一的。SID和用户名的关系跟人的姓名和身份证号码的关系是一样的。虽然有同名同姓的人，但他们的身份证号码绝对不会相同；虽然有相同的用户名(指网络上的，因为本地用户不能有相同的用户名)，但他们的SID绝对不同。这也就解释了为什么重装系统后即使使用之前的用户名和密码登陆也不能打开以前的加密文件。

　　所以在重装系统之前最好能把加密的数据全部解密。然而，为了应付突发的系统崩溃，就需要备份好自己密钥，这样系统崩溃后只要重装系统，并导入密钥，就可以继续使用之前的加密文件了。

　　备份密钥的方法是：单击“开始”→“运行”，输入：certmgr.msc，回车后打开“证书管理器”，在 “当前用户”→“个人”→“证书”目录下，右击颁发给你的证书，在“所有任务”中点击“导出”，并选择Export The Private Key(导出私钥)，其它选项按照默认设置。输入该用户的密码和保存路径就可以了。

　　在重装系统后，照旧运行certmgr.msc，并在“所有任务”中选择导入，选择好备份的证书，然后按照向导，就可以完成对密钥的导入。或直接在导出的pfx文件上点右键，选择“安装PFX”。这时，你的加密数据已经可以访问了。